# Docker Compose file for the FinOps Intelligence Dashboard

# This file defines the services (containers) that make up our application,
# allowing them to be run and managed together.
version: '3.8'

services:
  # --- PostgreSQL Database Service ---
  db:
    image: postgres:16-alpine # Use the official PostgreSQL 16 image
    container_name: finops_db
    environment:
      POSTGRES_USER: user # Database user
      POSTGRES_PASSWORD: password # Database password
      POSTGRES_DB: finops_db # Database name
    # Store data persistently outside the container to avoid data loss.
    # Data will be stored in a Docker volume named 'finops_pgdata'.
    volumes:
      - finops_pgdata:/var/lib/postgresql/data
    ports:
      - "5432:5432" # Map host port 5432 to container port 5432
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U user -d finops_db"]
      interval: 5s
      timeout: 5s
      retries: 5
    networks:
      - finops-network

# --- Docker Networks ---
# Define a custom bridge network for services to communicate with each other.
networks:
  finops-network:
    driver: bridge

# --- Docker Volumes ---
# Define named volumes for persistent data storage.
volumes:
  finops_pgdata:
